<html><head><title>testz: First Example</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Edmund Noble" /><meta name="description" content="Purely functional testing for Scala" /><meta name="og:image" content="/testz/img/poster.png" /><meta name="og:title" content="testz: First Example" /><meta name="og:site_name" content="testz" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Purely functional testing for Scala" /><link rel="icon" type="image/png" href="/testz/img/favicon.png" /><meta name="twitter:title" content="testz: First Example" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="Purely functional testing for Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="512x512" href="/testz/img/favicon.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/testz/highlight/styles/default.css" /><link rel="stylesheet" href="/testz/css/style.css" /><link rel="stylesheet" href="/testz/css/palette.css" /><link rel="stylesheet" href="/testz/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/testz/" class="brand"><div class="brand-wrapper"><span>testz</span></div></a></li><li><a href="/testz/docs/00-pitch.html" class="">Pitch</a></li><li><a href="/testz/docs/01-first-example.html" class=" active ">First Example</a></li><li><a href="/testz/docs/02-core.html" class="">testz-core</a></li><li><a href="/testz/docs/03-resource.html" class="">testz-resource</a></li><li><a href="/testz/docs/04-stdlib.html" class="">testz-stdlib</a></li><li><a href="/testz/docs/05-scalaz.html" class="">testz-scalaz</a></li><li><a href="/testz/docs/06-specs2.html" class="">testz-specs2</a></li><li><a href="/testz/docs/07-scalatest.html" class="">testz-scalatest</a></li><li><a href="/testz/docs/08-runner.html" class="">testz-runner</a></li><li><a href="/testz/docs/09-performance.html" class="">Performance</a></li><li><a href="/testz/docs/10-tests.html" class="">testz-util</a></li><li><a href="/testz/docs/11-util.html" class="">testz-util</a></li><li><a href="/testz/css/palette.css" class=""></a></li><li><a href="/testz/css/style.css" class=""></a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/scalaz/testz"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/scalaz/testz"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('testz Purely functional testing for Scala');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('testz Purely functional testing for Scala');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="scalaz" data-github-repo="testz"><div class="content-wrapper"><section><h1 id="first-example">First Example</h1>

<p>Let’s start with a simple, pure test suite, using the
most basic harness type provided. We’ll be using <code class="highlighter-rouge">testz-core</code>
and <code class="highlighter-rouge">testz-stdlib</code>, but the actual test code will only use <code class="highlighter-rouge">testz-core</code>.</p>

<p>Obligatory imports:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">testz.</span><span class="o">{</span><span class="nc">Harness</span><span class="o">,</span> <span class="nc">PureHarness</span><span class="o">,</span> <span class="n">assert</span><span class="o">}</span>
</code></pre></div></div>

<p>And here’s the meat.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">final</span> <span class="k">class</span> <span class="nc">MathTests</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">tests</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">harness</span><span class="k">:</span> <span class="kt">Harness</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">import</span> <span class="nn">harness._</span>
    <span class="n">section</span><span class="o">(</span>
      <span class="n">test</span><span class="o">(</span><span class="s">"say 1 + 1 == 2"</span><span class="o">)</span> <span class="o">{</span> <span class="o">()</span> <span class="k">=&gt;</span>
        <span class="n">assert</span><span class="o">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span>
      <span class="o">},</span>
      <span class="n">test</span><span class="o">(</span><span class="s">"say 2 * 2 == 4"</span><span class="o">)</span> <span class="o">{</span> <span class="o">()</span> <span class="k">=&gt;</span>
        <span class="n">assert</span><span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">4</span><span class="o">)</span>
      <span class="o">}</span>
    <span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>To run this test suite, pass it the <code class="highlighter-rouge">Harness</code> it wants.
First to do that we have to construct the <code class="highlighter-rouge">Harness</code>, using
<code class="highlighter-rouge">PureHarness.makeFromPrinter</code>; <code class="highlighter-rouge">makeFromPrinter</code> expects
an impure function which can be used to print test results
(<code class="highlighter-rouge">(List[String], Result) =&gt; Unit</code>), and that’s what we give it.</p>

<p>It will return a <code class="highlighter-rouge">T</code>, in this case <code class="highlighter-rouge">PureHarness.Uses[Unit]</code>,
which is <code class="highlighter-rouge">(Unit, List[String]) =&gt; TestOutput</code>.
<code class="highlighter-rouge">TestOutput</code> has a method <code class="highlighter-rouge">print()</code> which you can use to see the output.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">harness</span><span class="k">:</span> <span class="kt">Harness</span><span class="o">[</span><span class="kt">PureHarness.Uses</span><span class="o">[</span><span class="kt">Unit</span><span class="o">]]</span> <span class="k">=</span>
  <span class="nc">PureHarness</span><span class="o">.</span><span class="n">makeFromPrinter</span><span class="o">((</span><span class="n">result</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="n">println</span><span class="o">(</span><span class="n">s</span><span class="s">"${name.reverse.mkString("</span><span class="o">[</span><span class="kt">\</span><span class="err">""</span>, <span class="err">"</span><span class="kt">\</span><span class="err">"</span><span class="kt">-&gt;\</span><span class="err">""</span>, <span class="err">"</span><span class="kt">\</span><span class="err">"</span><span class="o">]</span><span class="k">:</span><span class="err">"</span><span class="o">)}</span> <span class="nc">$result</span><span class="s">")
  )
// harness: testz.Harness[testz.PureHarness.Uses[Unit]] = testz.ResourceHarness$$anon$1@50e3ee5c

(new MathTests()).tests(harness)((), Nil).print()
// ["</span><span class="n">say</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">2</span><span class="s">"]: Succeed
// ["</span><span class="n">say</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">4</span><span class="err">"]</span><span class="k">:</span> <span class="kt">Succeed</span>
</code></pre></div></div>

<p>For an example of how this is practically used, see the tests for testz itself <a href="https://github.com/scalaz/testz/blob/master/tests/src/main/scala/testz/Main.scala">here</a>.</p>

<p>I went through a lot there; let’s dissect that.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">testz.</span><span class="o">{</span><span class="nc">Harness</span><span class="o">,</span> <span class="nc">PureHarness</span><span class="o">,</span> <span class="n">assert</span><span class="o">}</span>
</code></pre></div></div>

<p>Here I import <code class="highlighter-rouge">Harness</code> (the simplest type of test harnesses),
<code class="highlighter-rouge">PureHarness</code> (an actual test harness implementation),
and the <code class="highlighter-rouge">assert</code> function.</p>

<p><code class="highlighter-rouge">PureHarness</code> is from testz-stdlib, and the others are from testz-core.</p>

<p>Conventionally, test suites are written with an abstract method
that takes some type of harness as a parameter and returns
a value it can only obtain from the harness.</p>

<p>Note: Test registration, intuitively, is not side effectful because
      of this. You can’t accidentally register a test
      from inside an assertion; the only tests you register are a single
      value.</p>

<p>I also import <code class="highlighter-rouge">assert</code> from <code class="highlighter-rouge">testz</code>; assertions are just values in
testz. <code class="highlighter-rouge">assert</code> returns either <code class="highlighter-rouge">Success()</code> if its argument is <code class="highlighter-rouge">True</code>,
or <code class="highlighter-rouge">Failure.noMessage</code> otherwise (a failure, with no message).</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">final</span> <span class="k">class</span> <span class="nc">MathTests</span> <span class="o">{</span>
</code></pre></div></div>

<p>We’re making a test suite class called <code class="highlighter-rouge">MathTests</code>.
We’ll be defining our tests inside.</p>

<p>Note: This is intentionally a class and not an object.
      testz encourages you not to use singleton objects as
      test suites. Using objects will prevent fields of
      test suites from being garbage collected during the run.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="n">tests</span><span class="o">[</span><span class="kt">T</span><span class="o">](</span><span class="n">harness</span><span class="k">:</span> <span class="kt">Harness</span><span class="o">[</span><span class="kt">T</span><span class="o">])</span><span class="k">:</span> <span class="kt">T</span> <span class="o">=</span> <span class="o">{</span>
</code></pre></div></div>

<p>Here we define a method in which we will define our tests.</p>

<p>Note: The type returned by <code class="highlighter-rouge">tests</code> is abstract,
      and in its parameters only appears in <code class="highlighter-rouge">Harness[T]</code>.
      This is because the only way to create a <code class="highlighter-rouge">T</code> is to
      define some tests with that harness. You can write
      your own suite type and give it any signature you
      want; you don’t even need to use testz’s <code class="highlighter-rouge">Harness</code>
      test harness types.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">harness._</span>
</code></pre></div></div>

<p>We also import all of the methods from <code class="highlighter-rouge">harness</code>;
we’ll use <code class="highlighter-rouge">section</code> and <code class="highlighter-rouge">test</code>, the test registration
primitives in <code class="highlighter-rouge">Harness</code> which are included in all harness types.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">section</span><span class="o">(</span>
</code></pre></div></div>

<p>Declaring a test section. Takes varargs parameters, of type <code class="highlighter-rouge">T</code>.
Returns a <code class="highlighter-rouge">T</code>. The only way other than <code class="highlighter-rouge">section</code> to get a <code class="highlighter-rouge">T</code>
(when it’s abstract) is <code class="highlighter-rouge">test</code>.</p>

<p>You can also include a name with the <code class="highlighter-rouge">section</code> by calling
<code class="highlighter-rouge">namedSection</code>, which accepts an additional parameter (<code class="highlighter-rouge">name: String</code>).</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="o">(</span><span class="s">"say 1 + 1 == 2"</span><span class="o">)</span> <span class="o">{</span> <span class="o">()</span> <span class="k">=&gt;</span>
</code></pre></div></div>

<p>And here’s a test definition, using <code class="highlighter-rouge">test.apply</code>.
The first parameter is the name of the test. The parameter in the
second (curried) parameter list is a function <code class="highlighter-rouge">() =&gt; TestResult</code>.</p>

<p>Note: <code class="highlighter-rouge">() =&gt;</code> is actually needed to avoid computing test registrations
      and tests at the same time. testz doesn’t use by-names.
      If you <em>do</em> want a <code class="highlighter-rouge">Harness</code> with by-names or with test registrations
      adjacent to tests, this is something you can alter.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">assert</span><span class="o">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span>
</code></pre></div></div>

<p>Here’s the assertion inside.
It’ll give you a <code class="highlighter-rouge">Result</code> which is <code class="highlighter-rouge">Fail()</code> if the two
arguments aren’t equal using <code class="highlighter-rouge">===</code>, and otherwise <code class="highlighter-rouge">Succeed()</code>.</p>

<p>The next assertion, all together:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="o">(</span><span class="s">"say 2 * 2 == 4"</span><span class="o">)</span> <span class="o">{</span> <span class="o">()</span> <span class="k">=&gt;</span>
  <span class="n">assert</span><span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">4</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>And we’re done.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/testz/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'scalaz/testz'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/testz/js/main.js"></script></body></html>